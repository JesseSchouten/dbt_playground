version: 2

sources:
  - name: crm_dataset
    database: "{{ target.catalog }}"
    schema: "{{ target.schema }}"
    description: crm dataset
    tables:
      - name: crm_customers
        tags:
          - databricks_generated
          - candy_store
        description: raw candy store customer data
        columns:
          - name: customer_id
            description: Id of the customer field.
            tests:
              - unique:
                  config:   
                    limit: 10
              - not_null
          - name: status
            description: status of the customer
            tests:
              - accepted_values: 
                  values: 
                    ['active', 'inactive', 'blocked']
          - name: first_name
            description: first name of the customer
            tests:  
              - not_null:
                  config: 
                    severity: warn
          - name: last_name
            description: last name of the customer
            tests:
              - not_null:
                  config:
                    severity: warn
          - name: last_purchase_timestamp
            description: timestamp of the last order purchase of customers